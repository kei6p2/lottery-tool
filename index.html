<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="ãã˜å¼•ããƒ»æŠ½é¸ãƒ„ãƒ¼ãƒ«ã§ç°¡å˜ãƒ»æ¥½ã—ãåå‰æŠ½é¸ï¼ã‚«ã‚¹ã‚¿ãƒ ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç››ã‚Šä¸Šã’ã‚ˆã†ï¼" />
  <meta name="keywords" content="æŠ½é¸ãƒ„ãƒ¼ãƒ«, ãƒ©ãƒ³ãƒ€ãƒ æŠ½é¸, å®ãã˜, ã‚¤ãƒ™ãƒ³ãƒˆæŠ½é¸" />
  <meta property="og:title" content="ãã˜å¼•ããƒ»æŠ½é¸ãƒ„ãƒ¼ãƒ«" />
  <meta property="og:description" content="ã‚·ãƒ³ãƒ—ãƒ«ã§æ¥½ã—ã„åå‰æŠ½é¸ãƒ„ãƒ¼ãƒ«ï¼çµæœã‚’ã‚·ã‚§ã‚¢ã—ã¦ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç››ã‚Šä¸Šã’ã‚ˆã†ï¼" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://kei6p2.github.io/lottery-tool/" />
  <meta property="og:image" content="https://kei6p2.github.io/lottery-tool/og-image.jpg" />
  <title>ãã˜å¼•ããƒ»æŠ½é¸ãƒ„ãƒ¼ãƒ«</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" defer></script>
  <script defer>
    // æ³¨æ„: ã“ã®ã‚³ãƒ¼ãƒ‰ã¯HTTPSç’°å¢ƒã§å‹•ä½œã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼ˆnavigator.share ã‚„ navigator.clipboard ã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ï¼‰ã€‚
    // ã‚µãƒ¼ãƒãƒ¼ä¸Šã§UTF-8ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’æ­£ã—ãè¨­å®šã—ã¦ãã ã•ã„ï¼ˆä¾‹: .htaccessã§AddDefaultCharset UTF-8ï¼‰ã€‚

    // ç¥ç¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    const defaultMessages = [
      'ãŠã‚ã§ã¨ã†ï¼ç´ æ™´ã‚‰ã—ã„é‹ã®æŒã¡ä¸»ï¼',
      'ã‚„ã£ãŸã­ï¼å½“é¸ãŠã‚ã§ã¨ã†ï¼',
      'ã‚­ãƒŸãŒä¸»å½¹ã ï¼ãŠã‚ã§ã¨ã†ï¼',
      'é‹å‘½ã®å½“é¸ï¼ãŠã‚ã§ã¨ã†ï¼'
    ];

    // Base64ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ï¼ˆURLã‚»ãƒ¼ãƒ•ï¼‰
    function base64urlEncode(str) {
      try {
        return btoa(unescape(encodeURIComponent(str)))
          .replace(/\+/g, '-').replace(/\//g, '_').replace(/=+$/, '');
      } catch (e) {
        console.error('Base64ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚¨ãƒ©ãƒ¼:', e);
        showModal('ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚');
        return '';
      }
    }

    // Base64ãƒ‡ã‚³ãƒ¼ãƒ‰ï¼ˆURLã‚»ãƒ¼ãƒ•ï¼‰
    function base64urlDecode(str) {
      try {
        str = str.replace(/-/g, '+').replace(/_/g, '/');
        while (str.length % 4) str += '=';
        return decodeURIComponent(escape(atob(str)));
      } catch (e) {
        console.error('Base64ãƒ‡ã‚³ãƒ¼ãƒ‰ã‚¨ãƒ©ãƒ¼:', e);
        return '';
      }
    }

    function getParam(name) {
      try {
        const url = new URL(window.location.href);
        return url.searchParams.get(name);
      } catch (e) {
        console.error('URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å–å¾—ã‚¨ãƒ©ãƒ¼:', e);
        return null;
      }
    }

    function updateURL(dataStr) {
      try {
        if (window.location.protocol !== 'about:') {
          const url = new URL(window.location.href);
          url.searchParams.set('data', dataStr);
          window.history.replaceState(null, '', url);
        } else {
          console.log('about:srcdoc ç’°å¢ƒã®ãŸã‚ã€URLæ›´æ–°ã‚’ã‚¹ã‚­ãƒƒãƒ—');
        }
      } catch (e) {
        console.error('URLæ›´æ–°ã‚¨ãƒ©ãƒ¼:', e);
        showModal('URLã®æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸã€‚');
      }
    }

    function showModal(message) {
      const modal = document.getElementById('modal');
      const modalMessage = document.getElementById('modalMessage');
      modalMessage.textContent = message;
      modal.style.display = 'flex';
      modal.classList.add('modal-show');
    }

    function closeModal() {
      const modal = document.getElementById('modal');
      modal.classList.remove('modal-show');
      setTimeout(() => {
        modal.style.display = 'none';
      }, 300);
    }

    function updateNameCount() {
      const textarea = document.getElementById('nameInput');
      const names = textarea.value.trim().split('\n').map(n => n.trim()).filter(Boolean);
      document.getElementById('nameCount').textContent = `å…¥åŠ›äººæ•°: ${names.length}äºº`;
    }

    function insertSampleNames() {
      const textarea = document.getElementById('nameInput');
      textarea.value = `ãƒ¦ãƒ¼ã‚¶ãƒ¼1\nãƒ¦ãƒ¼ã‚¶ãƒ¼2\nãƒ¦ãƒ¼ã‚¶ãƒ¼3\nãƒ¦ãƒ¼ã‚¶ãƒ¼4\nãƒ¦ãƒ¼ã‚¶ãƒ¼5`;
      updateNameCount();
    }

    function setDrawCount(count) {
      document.getElementById('drawCount').value = count;
      startDraw();
    }

    function showDrawAnimation(names) {
      const drawAnimation = document.getElementById('drawAnimation');
      drawAnimation.style.display = 'block';
      drawAnimation.classList.add('animate-pulse');
      let interval = setInterval(() => {
        const randomName = names[Math.floor(Math.random() * names.length)];
        drawAnimation.textContent = `æŠ½é¸ä¸­: ${randomName}`;
      }, 100);
      return () => {
        clearInterval(interval);
        drawAnimation.classList.remove('animate-pulse');
        drawAnimation.style.display = 'none';
        drawAnimation.textContent = '';
      };
    }

    function showResult(winners, showRanking, customMessage) {
      const resultDiv = document.getElementById('result');
      const message = customMessage || defaultMessages[Math.floor(Math.random() * defaultMessages.length)];
      resultDiv.innerHTML = `<div class="result-message">${message}</div>`;
      winners.forEach((winner, index) => {
        setTimeout(() => {
          const winnerDiv = document.createElement('div');
          winnerDiv.className = 'winner-item';
          winnerDiv.textContent = showRanking ? `${index + 1}ä½: ${winner}` : `ğŸ‰ ${winner}`;
          winnerDiv.style.animationDelay = `${index * 0.5}s`;
          resultDiv.appendChild(winnerDiv);
        }, index * 500);
      });
    }

    function startDraw() {
      console.log('startDraw å®Ÿè¡Œé–‹å§‹');
      const textarea = document.getElementById('nameInput');
      const inputCount = document.getElementById('drawCount');
      const allowDuplicates = document.getElementById('allowDuplicates').checked;
      const showRanking = document.getElementById('showRanking').checked;
      const customMessage = document.getElementById('customMessage').value.trim();
      const loadingBar = document.getElementById('loadingBar');
      const loadingBarFill = document.getElementById('loadingBarFill');
      const resultDiv = document.getElementById('result');
      const copyBtn = document.getElementById('copyBtn');
      const shareBtn = document.getElementById('shareBtn');
      const exportBtn = document.getElementById('exportBtn');
      const imageBtn = document.getElementById('imageBtn');

      let rawNames = textarea.value.trim().split('\n').map(n => n.trim()).filter(Boolean);
      console.log('å…¥åŠ›ã•ã‚ŒãŸåå‰:', rawNames);

      if (!allowDuplicates) {
        rawNames = [...new Set(rawNames)];
      }

      const count = parseInt(inputCount.value);

      if (rawNames.length === 0) {
        showModal('åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚');
        return;
      }
      if (isNaN(count) || count < 1 || (!allowDuplicates && count > rawNames.length)) {
        showModal('æŠ½é¸äººæ•°ã¯1ä»¥ä¸Šã€ã‹ã¤åå‰ã®æ•°ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„ï¼ˆé‡è¤‡è¨±å¯æ™‚ã¯é™¤ãï¼‰ã€‚');
        return;
      }

      resultDiv.textContent = '';
      copyBtn.style.display = 'none';
      shareBtn.style.display = 'none';
      exportBtn.style.display = 'none';
      imageBtn.style.display = 'none';
      loadingBar.style.display = 'block';
      loadingBarFill.style.animation = 'none';
      void loadingBarFill.offsetWidth;
      loadingBarFill.style.animation = 'loading 3s ease-in-out forwards';

      const stopAnimation = showDrawAnimation(rawNames);

      setTimeout(() => {
        try {
          stopAnimation();
          let winners = [];
          if (allowDuplicates) {
            for (let i = 0; i < count; i++) {
              const randomIndex = Math.floor(Math.random() * rawNames.length);
              winners.push(rawNames[randomIndex]);
            }
          } else {
            const shuffled = [...rawNames].sort(() => 0.5 - Math.random());
            winners = shuffled.slice(0, count);
          }

          console.log('å½“é¸è€…:', winners);
          loadingBar.style.display = 'none';
          showResult(winners, showRanking, customMessage);

          const dataStr = base64urlEncode(JSON.stringify(winners));
          if (dataStr) {
            updateURL(dataStr);
          }

          copyBtn.style.display = 'inline-block';
          shareBtn.style.display = 'inline-block';
          exportBtn.style.display = 'inline-block';
          imageBtn.style.display = 'inline-block';
        } catch (e) {
          console.error('æŠ½é¸å‡¦ç†ã‚¨ãƒ©ãƒ¼:', e);
          showModal('æŠ½é¸ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚');
          loadingBar.style.display = 'none';
          stopAnimation();
        }
      }, 3000);
    }

    function resetForm() {
      const textarea = document.getElementById('nameInput');
      const inputCount = document.getElementById('drawCount');
      const customMessage = document.getElementById('customMessage');
      const resultDiv = document.getElementById('result');
      const copyBtn = document.getElementById('copyBtn');
      const shareBtn = document.getElementById('shareBtn');
      const exportBtn = document.getElementById('exportBtn');
      const imageBtn = document.getElementById('imageBtn');
      textarea.value = '';
      inputCount.value = '1';
      customMessage.value = '';
      document.getElementById('allowDuplicates').checked = false;
      document.getElementById('showRanking').checked = false;
      resultDiv.textContent = '';
      copyBtn.style.display = 'none';
      shareBtn.style.display = 'none';
      exportBtn.style.display = 'none';
      imageBtn.style.display = 'none';
      try {
        if (window.location.protocol !== 'about:') {
          window.history.replaceState(null, '', window.location.pathname);
        }
      } catch (e) {
        console.error('ãƒªã‚»ãƒƒãƒˆæ™‚ã®URLã‚¯ãƒªã‚¢ã‚¨ãƒ©ãƒ¼:', e);
      }
      updateNameCount();
    }

    function copyURL() {
      try {
        const url = window.location.href;
        navigator.clipboard.writeText(url).then(() => {
          showModal('URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼');
        }).catch(() => {
          showModal('ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚æ‰‹å‹•ã§ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ã€‚');
        });
      } catch (e) {
        console.error('URLã‚³ãƒ”ãƒ¼ã‚¨ãƒ©ãƒ¼:', e);
        showModal('URLã®ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚');
      }
    }

    function shareResult() {
      try {
        const url = window.location.href;
        const text = 'ãã˜å¼•ããƒ»æŠ½é¸ãƒ„ãƒ¼ãƒ«ã§æŠ½é¸ã—ãŸçµæœã‚’ãƒã‚§ãƒƒã‚¯ï¼';
        if (navigator.share) {
          navigator.share({
            title: 'ãã˜å¼•ããƒ»æŠ½é¸ãƒ„ãƒ¼ãƒ«',
            text: text,
            url: url
          }).catch(() => showModal('ã‚·ã‚§ã‚¢ã«å¤±æ•—ã—ã¾ã—ãŸã€‚'));
        } else {
          showModal('ã“ã®ãƒ–ãƒ©ã‚¦ã‚¶ã§ã¯ã‚·ã‚§ã‚¢æ©Ÿèƒ½ãŒä½¿ãˆã¾ã›ã‚“ã€‚URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ã‚·ã‚§ã‚¢ã—ã¦ãã ã•ã„ã€‚');
        }
      } catch (e) {
        console.error('ã‚·ã‚§ã‚¢ã‚¨ãƒ©ãƒ¼:', e);
        showModal('ã‚·ã‚§ã‚¢ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚');
      }
    }

    function exportResult() {
      try {
        const resultDiv = document.getElementById('result');
        const customMessage = document.getElementById('customMessage').value.trim();
        const winners = Array.from(resultDiv.querySelectorAll('.winner-item')).map(div => div.textContent.replace(/^\d+ä½: /, '').replace('ğŸ‰ ', ''));
        if (winners.length === 0) {
          showModal('ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹çµæœãŒã‚ã‚Šã¾ã›ã‚“ã€‚');
          return;
        }
        const fileName = customMessage ? `${customMessage.replace(/\s+/g, '_')}_${new Date().toISOString().replace(/[:.]/g, '-')}` : `lottery_result_${new Date().toISOString().replace(/[:.]/g, '-')}`;
        const csvContent = 'data:text/csv;charset=utf-8,' + winners.map(w => `"${w}"`).join('\n');
        const encodedUri = encodeURI(csvContent);
        const link = document.createElement('a');
        link.setAttribute('href', encodedUri);
        link.setAttribute('download', `${fileName}.csv`);
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      } catch (e) {
        console.error('CSVã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã‚¨ãƒ©ãƒ¼:', e);
        showModal('CSVã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã«å¤±æ•—ã—ã¾ã—ãŸã€‚');
      }
    }

    function downloadImage() {
      try {
        const resultDiv = document.getElementById('result');
        const customMessage = document.getElementById('customMessage').value.trim();
        if (!resultDiv.querySelectorAll('.winner-item').length) {
          showModal('ç”»åƒã‚’ç”Ÿæˆã™ã‚‹çµæœãŒã‚ã‚Šã¾ã›ã‚“ã€‚');
          return;
        }
        const fileName = customMessage ? `${customMessage.replace(/\s+/g, '_')}_${new Date().toISOString().replace(/[:.]/g, '-')}` : `lottery_result_${new Date().toISOString().replace(/[:.]/g, '-')}`;
        html2canvas(resultDiv).then(canvas => {
          const link = document.createElement('a');
          link.href = canvas.toDataURL('image/png');
          link.download = `${fileName}.png`;
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
        }).catch(() => showModal('ç”»åƒã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸã€‚'));
      } catch (e) {
        console.error('ç”»åƒç”Ÿæˆã‚¨ãƒ©ãƒ¼:', e);
        showModal('ç”»åƒã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸã€‚');
      }
    }

    // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
    function initializeEventListeners() {
      console.log('ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼åˆæœŸåŒ–é–‹å§‹');
      document.getElementById('sampleBtn').addEventListener('click', insertSampleNames);
      document.getElementById('startDrawBtn').addEventListener('click', startDraw);
      document.getElementById('quickDraw1').addEventListener('click', () => setDrawCount(1));
      document.getElementById('quickDraw2').addEventListener('click', () => setDrawCount(2));
      document.getElementById('quickDraw3').addEventListener('click', () => setDrawCount(3));
      document.getElementById('resetBtn').addEventListener('click', resetForm);
      document.getElementById('copyBtn').addEventListener('click', copyURL);
      document.getElementById('shareBtn').addEventListener('click', shareResult);
      document.getElementById('exportBtn').addEventListener('click', exportResult);
      document.getElementById('imageBtn').addEventListener('click', downloadImage);
      document.getElementById('closeModalBtn').addEventListener('click', closeModal);
      document.getElementById('nameInput').addEventListener('input', updateNameCount);
      console.log('ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼åˆæœŸåŒ–å®Œäº†');
    }

    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«å®Ÿè¡Œ
    window.onload = () => {
      try {
        console.log('ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿é–‹å§‹');
        document.body.classList.add('loaded');
        const dataStr = getParam('data');
        const copyBtn = document.getElementById('copyBtn');
        const shareBtn = document.getElementById('shareBtn');
        const exportBtn = document.getElementById('exportBtn');
        const imageBtn = document.getElementById('imageBtn');
        if (dataStr) {
          const decoded = base64urlDecode(dataStr);
          if (decoded) {
            const winners = JSON.parse(decoded);
            if (Array.isArray(winners) && winners.length > 0) {
              const showRanking = winners.some(w => /^\d+ä½: /.test(w));
              showResult(winners, showRanking, '');
              copyBtn.style.display = 'inline-block';
              shareBtn.style.display = 'inline-block';
              exportBtn.style.display = 'inline-block';
              imageBtn.style.display = 'inline-block';
            }
          }
        }
        updateNameCount();
        initializeEventListeners();
        console.log('ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å®Œäº†');
      } catch (e) {
        console.error('ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', e);
        showModal('ãƒšãƒ¼ã‚¸ã®åˆæœŸåŒ–ã«å¤±æ•—ã—ã¾ã—ãŸã€‚');
      }
    };
  </script>
  <style>
    body {
      margin: 0;
      padding: 2rem;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #f0f9ff, #cbebff);
      color: #333;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      opacity: 0;
      transition: opacity 0.5s ease-in;
    }
    body.loaded {
      opacity: 1;
    }
    h1 {
      font-size: 3rem;
      margin-bottom: 1rem;
      color: #007acc;
      text-shadow: 0 0 10px rgba(0, 122, 204, 0.3);
      animation: glow 2s ease-in-out infinite alternate;
      transform: translateY(-20px);
      opacity: 0;
      animation: slideIn 0.5s ease-out forwards;
    }
    @keyframes slideIn {
      to { transform: translateY(0); opacity: 1; }
    }
    @keyframes glow {
      from { text-shadow: 0 0 10px rgba(0, 122, 204, 0.3); }
      to { text-shadow: 0 0 20px rgba(0, 122, 204, 0.7); }
    }
    p {
      font-size: 1.1rem;
      color: #555;
      margin-bottom: 1rem;
      text-align: center;
      max-width: 600px;
      opacity: 0;
      transform: translateY(20px);
      animation: slideIn 0.5s ease-out 0.2s forwards;
    }
    #nameCount {
      font-size: 1rem;
      color: #007acc;
      margin-bottom: 0.5rem;
      opacity: 0;
      animation: slideIn 0.5s ease-out 0.3s forwards;
    }
    textarea {
      width: 90%;
      max-width: 600px;
      height: 150px;
      padding: 1rem;
      font-size: 1rem;
      border: 2px solid #00aaff;
      border-radius: 12px;
      background-color: rgba(255, 255, 255, 0.95);
      margin-bottom: 0.5rem;
      resize: none;
      transition: border-color 0.3s, transform 0.3s, box-shadow 0.3s;
      opacity: 0;
      animation: slideIn 0.5s ease-out 0.4s forwards;
    }
    textarea:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 170, 255, 0.2);
    }
    textarea:focus {
      border-color: #007acc;
      outline: none;
      box-shadow: 0 0 8px rgba(0, 122, 204, 0.4);
    }
    input[type="number"], input[type="text"] {
      width: 150px;
      padding: 0.5rem;
      font-size: 1rem;
      margin: 0.5rem;
      border: 2px solid #00aaff;
      border-radius: 8px;
      transition: border-color 0.3s, transform 0.3s, box-shadow 0.3s;
      opacity: 0;
      animation: slideIn 0.5s ease-out 0.5s forwards;
    }
    input[type="number"]:hover, input[type="text"]:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 170, 255, 0.2);
    }
    input[type="number"]:focus, input[type="text"]:focus {
      border-color: #007acc;
      outline: none;
      box-shadow: 0 0 8px rgba(0, 122, 204, 0.4);
    }
    .options {
      display: flex;
      gap: 1rem;
      margin-bottom: 1rem;
      flex-wrap: wrap;
      justify-content: center;
      opacity: 0;
      animation: slideIn 0.5s ease-out 0.6s forwards;
    }
    .options label {
      font-size: 1rem;
      color: #555;
      transition: color 0.3s;
    }
    .options label:hover {
      color: #007acc;
    }
    .button-group {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
      justify-content: center;
      opacity: 0;
      animation: slideIn 0.5s ease-out 0.7s forwards;
    }
    button {
      background: #00aaff;
      color: white;
      font-size: 1.2rem;
      padding: 0.7rem 2rem;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      transition: transform 0.2s, background 0.3s, box-shadow 0.3s;
      box-shadow: 0 0 10px rgba(0, 170, 255, 0.3);
      position: relative;
      overflow: hidden;
    }
    button::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(
        90deg,
        transparent,
        rgba(255, 255, 255, 0.2),
        transparent
      );
      transition: left 0.4s;
    }
    button:hover::after {
      left: 100%;
    }
    button:hover {
      background: #007acc;
      transform: translateY(-3px);
      box-shadow: 0 6px 15px rgba(0, 122, 204, 0.4);
    }
    button:active {
      transform: translateY(0);
      box-shadow: 0 2px 5px rgba(0, 122, 204, 0.2);
    }
    button.reset { background: #ff5555; }
    button.reset:hover { background: #cc3333; }
    button.quick-draw { background: #55aa55; }
    button.quick-draw:hover { background: #448844; }
    button.sample { background: #ffaa00; }
    button.sample:hover { background: #cc8800; }
    #loadingBar {
      width: 90%;
      max-width: 400px;
      height: 20px;
      background: #eee;
      border-radius: 10px;
      overflow: hidden;
      margin: 1rem 0;
      display: none;
      position: relative;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }
    #loadingBarFill {
      width: 0;
      height: 100%;
      background: linear-gradient(90deg, #00ccff, #0099ff, #00ccff);
      background-size: 200% 100%;
      animation: loading 3s ease-in-out forwards, gradientShift 2s ease infinite;
      position: relative;
      overflow: hidden;
    }
    #loadingBarFill::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(
        45deg,
        rgba(255, 255, 255, 0.2) 25%,
        transparent 25%,
        transparent 50%,
        rgba(255, 255, 255, 0.2) 50%,
        rgba(255, 255, 255, 0.2) 75%,
        transparent 75%,
        transparent
      );
      background-size: 30px 30px;
      animation: sparkle 1s linear infinite;
    }
    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      100% { background-position: 200% 50%; }
    }
    @keyframes sparkle {
      0% { background-position: 0 0; }
      100% { background-position: 30px 30px; }
    }
    @keyframes loading {
      from { width: 0; }
      to { width: 100%; }
    }
    #drawAnimation {
      font-size: 1.5rem;
      color: #003366;
      margin: 1rem 0;
      display: none;
      text-align: center;
      transition: opacity 0.3s;
    }
    #drawAnimation.animate-pulse {
      animation: pulse 0.5s ease-in-out infinite;
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.7; transform: scale(1.05); }
    }
    #result {
      margin-top: 2rem;
      font-size: 1.5rem;
      color: #003366;
      background: rgba(255, 255, 255, 0.9);
      padding: 1rem 2rem;
      border-radius: 15px;
      box-shadow: 0 0 10px rgba(0, 122, 204, 0.2);
      white-space: pre-line;
      text-align: center;
      opacity: 0;
      animation: slideIn 0.5s ease-out forwards;
    }
    .result-message {
      font-weight: bold;
      margin-bottom: 1rem;
      animation: bounce 0.5s ease-out;
    }
    .winner-item {
      opacity: 0;
      transform: translateY(30px) scale(0.8);
      animation: bounceIn 0.6s ease-out forwards;
      padding: 0.5rem;
      margin: 0.2rem;
      border-radius: 8px;
      background: linear-gradient(45deg, #e6f3ff, #ffffff);
      box-shadow: 0 0 5px rgba(0, 122, 204, 0.3);
      transition: transform 0.2s;
    }
    .winner-item:hover {
      transform: scale(1.02);
    }
    @keyframes bounceIn {
      0% { opacity: 0; transform: translateY(30px) scale(0.8); }
      60% { opacity: 1; transform: translateY(-10px) scale(1.05); }
      100% { opacity: 1; transform: translateY(0) scale(1); }
    }
    @keyframes bounce {
      0% { transform: scale(0.8); opacity: 0; }
      60% { transform: scale(1.1); opacity: 1; }
      100% { transform: scale(1); opacity: 1; }
    }
    #copyBtn, #shareBtn, #exportBtn, #imageBtn {
      display: none;
      margin-top: 1rem;
      padding: 0.6rem 1.2rem;
      font-size: 1rem;
      border: none;
      border-radius: 10px;
      background: #00aaff;
      color: #fff;
      cursor: pointer;
      box-shadow: 0 0 10px rgba(0, 170, 255, 0.3);
      transition: background 0.3s, transform 0.2s, box-shadow 0.3s;
      position: relative;
      overflow: hidden;
      opacity: 0;
      animation: slideIn 0.5s ease-out forwards;
    }
    #copyBtn::after, #shareBtn::after, #exportBtn::after, #imageBtn::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(
        90deg,
        transparent,
        rgba(255, 255, 255, 0.2),
        transparent
      );
      transition: left 0.4s;
    }
    #copyBtn:hover::after, #shareBtn:hover::after, #exportBtn:hover::after, #imageBtn:hover::after {
      left: 100%;
    }
    #copyBtn:hover, #shareBtn:hover, #exportBtn:hover, #imageBtn:hover {
      background: #007acc;
      transform: translateY(-3px);
      box-shadow: 0 6px 15px rgba(0, 122, 204, 0.4);
    }
    #copyBtn:active, #shareBtn:active, #exportBtn:active, #imageBtn:active {
      transform: translateY(0);
      box-shadow: 0 2px 5px rgba(0, 122, 204, 0.2);
    }
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      justify-content: center;
      align-items: center;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    .modal.modal-show {
      opacity: 1;
    }
    .modal-content {
      background: white;
      padding: 2rem;
      border-radius: 12px;
      text-align: center;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
      transform: scale(0.7);
      transition: transform 0.3s ease;
    }
    .modal.modal-show .modal-content {
      transform: scale(1);
    }
    .modal-content button {
      margin-top: 1rem;
    }
    @media (max-width: 600px) {
      h1 { font-size: 2rem; }
      textarea, input[type="number"], input[type="text"] { width: 95%; }
      button { font-size: 1rem; padding: 0.5rem 1.5rem; }
      #result { font-size: 1.2rem; }
      .options { flex-direction: column; }
    }
  </style>
</head>
<body>
  <h1>ãã˜å¼•ããƒ»æŠ½é¸ãƒ„ãƒ¼ãƒ« ğŸ‰</h1>
  <p>åå‰ã‚’1è¡Œãšã¤å…¥åŠ›ã—ã¦ã€æŠ½é¸äººæ•°ã‚’é¸ã‚“ã§ã€ŒæŠ½é¸é–‹å§‹ã€ã‚’æŠ¼ã—ã¦ãã ã•ã„ï¼</p>
  <div class="options">
    <label><input type="checkbox" id="allowDuplicates"> é‡è¤‡ã‚’è¨±å¯ï¼ˆåŒã˜äººãŒè¤‡æ•°å›å½“é¸å¯èƒ½ï¼‰</label>
    <label><input type="checkbox" id="showRanking"> é †ä½ã‚’è¡¨ç¤ºï¼ˆ1ä½ã€2ä½â€¦ï¼‰</label>
    <label>ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: <input type="text" id="customMessage" placeholder="ä¾‹: è±ªè¯è³å“ã‚²ãƒƒãƒˆï¼"></label>
  </div>
  <textarea id="nameInput" placeholder="ä¾‹ï¼š
ãƒ¦ãƒ¼ã‚¶ãƒ¼1
ãƒ¦ãƒ¼ã‚¶ãƒ¼2
ãƒ¦ãƒ¼ã‚¶ãƒ¼3"></textarea>
  <div id="nameCount">å…¥åŠ›äººæ•°: 0äºº</div>
  <div class="button-group">
    <button id="sampleBtn" class="sample">ã‚µãƒ³ãƒ—ãƒ«åã‚’æŒ¿å…¥</button>
  </div>
  <label>æŠ½é¸äººæ•°: <input type="number" id="drawCount" min="1" value="1" /></label>
  <div class="button-group">
    <button id="startDrawBtn">æŠ½é¸é–‹å§‹</button>
    <button id="quickDraw1" class="quick-draw">1äººæŠ½é¸</button>
    <button id="quickDraw2" class="quick-draw">2äººæŠ½é¸</button>
    <button id="quickDraw3" class="quick-draw">3äººæŠ½é¸</button>
    <button id="resetBtn" class="reset">ãƒªã‚»ãƒƒãƒˆ</button>
  </div>

  <div id="loadingBar">
    <div id="loadingBarFill"></div>
  </div>
  <div id="drawAnimation"></div>

  <div id="result"></div>
  <div class="button-group">
    <button id="copyBtn">çµæœURLã‚’ã‚³ãƒ”ãƒ¼</button>
    <button id="shareBtn">SNSã§ã‚·ã‚§ã‚¢</button>
    <button id="exportBtn">CSVã§ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
    <button id="imageBtn">çµæœã‚’ç”»åƒã§ä¿å­˜</button>
  </div>

  <div id="modal" class="modal">
    <div class="modal-content">
      <p id="modalMessage"></p>
      <button id="closeModalBtn">é–‰ã˜ã‚‹</button>
    </div>
  </div>

  <canvas id="resultCanvas" style="display: none;"></canvas>
</body>
</html>